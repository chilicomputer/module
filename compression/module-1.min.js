/*! gruntest 2014-06-17 */
!function(a){var b={};b.info="VERSION: 1.0.0 \n AUTHOR: liuping \n A Controller For Modules";var c={initFnName:"init",destroyFnName:"destroy",autoLoad:!0,sourceRoot:""},d={priorityQueue:{list:[],cbks:{}},historyQueue:[],busyState:{},globalLock:!1,addQueue:function(a,b){var c=e.parseObj({power:0,callBack:function(){}},b||{},!0);d.busyState[a]=!0,d.priorityQueue.list.splice(c.power,0,a),d.priorityQueue.cbks[a]||(d.priorityQueue.cbks[a]=[]),d.priorityQueue.cbks[a].push(c.callBack)},jsTagCreat:function(a){d.globalLock=!0;for(var b=e.parseObj({isAsyn:!0,isClear:!0},a||{});d.priorityQueue.list.length>0;){var f=d.priorityQueue.list.pop(),g=d.priorityQueue.cbks[f],h=document.createElement("script");h.type="text/javascript",h.defer=b.isAsyn,h.src=c.sourceRoot+f,b.isAsyn&&("onreadystatechange"in h?h.onreadystatechange=function(){var a=h.readyState;if("loaded"==a.toLowerCase()||"complete"==a.toLowerCase()){for(var c=0,i=g.length;i>c;c++)g[c](f);delete d.priorityQueue.cbks[f],d.busyState[f]=!1,b.isClear&&e.removeNode(h),d.historyQueue.push(f)}}:h.onload=function(){for(var a=0,c=g.length;c>a;a++)g[a](f);delete d.priorityQueue.cbks[f],d.busyState[f]=!1,b.isClear&&e.removeNode(h),d.historyQueue.push(f)}),document.body.appendChild(h)}0==d.priorityQueue.list.length&&(d.globalLock=!1)},loader:function(a,b){if(!e.isArray(a)){var a=e.trim(a),c=e.parseObj({isAsyn:!0,power:0,isClear:!0,callBack:function(){}},b||{},!0);return-1!=e.indexOf(a,d.historyQueue)?void c.callBack(a):void(d.priorityQueue.cbks[a]?d.addQueue(a,c):(d.addQueue(a,c),d.globalLock||d.jsTagCreat(c)))}for(var f=0;f<a.length;f++)d.loader(a[f],b)}},e=a.basetools,f=function(){var a={},b={};this.push=function(c,d,f){var h="";if(d.constructor==g)h=d.mName||e.unikey();else{if("string"!=typeof d)throw"MSG pushing error!";h=d}var i="__MSG__"+h,j=f.mName,k={data:c,sender:j,receiver:h},l=b[i]?b[i].length:0;if(!l)return a[i]?a[i].push(k):a[i]=[k],i;for(var m=0;l>m;m++){var n=b[i][m];n&&n(k)}},this.get=function(b){var c="";if(b.constructor==g)c=b.mName;else{if("string"!=typeof b)throw"MSG getting error!";c=b}if(c){var d="__MSG__"+c,e=a[d];return a[d]=[],e&&e.length?e:void 0}},this.addHandler=function(a,c){var d="";if(a.constructor==g)d=a.mName;else{if("string"!=typeof a)throw"MSG adding handler error!";d=a}if(d){var e="__MSG__"+d;b[e]?b[e].push(c):b[e]=[c]}},this.delHandler=function(a,c){var d="";if(a.constructor==g)d=a.mName;else{if("string"!=typeof a)throw"MSG deleting handler error!";d=a}if(d){var e="__MSG__"+d,f=0;if(b[e]&&(f=b[e].length))if(c)for(var h=0;f>h;h++)b[e][h]==c&&b[e].splice(h,0,1);else b[e]=[]}}},g=function(a){var b={};this.skipRecord=function(a,c){a&&(b[a]=!!c)},this.needSkip=function(a){var c=!1;return b.hasOwnProperty(a)&&(c=b[a]),c},this.mName=a,this.rLink=[],this.logList=[],this.interface={},this.__tailState=!1,this.mUsable=!0},h={},i={},j=new f;g.prototype.tailLog=function(a){"undefined"==typeof a&&(a=!0),a&&!this.__tailState&&a&&this.showLog(),this.__tailState=a},g.prototype.log=function(a,b){var c=e.getTime("-"),d="LOG["+(b||"normal")+"]:"+a+" At "+c+"\n";this.__tailState&&e.consoleLog(d),this.logList[this.logList.length]=d},g.prototype.showLog=function(){var a=this.logList.join("");return e.consoleLog(a),a},g.prototype.tools=e,g.prototype.build=function(){if(!this.mUsable)return void this.log('No permission for "building"!',"Error");var a,b={};switch(typeof arguments[0]){case"object":b=arguments[0],a=arguments[1],"string"==typeof arguments[2]&&(arguments[0].hasOwnProperty(arguments[2])?b[arguments[2]]=arguments[0][arguments[2]]:b={});break;case"string":b[arguments[0]]=arguments[1],a=arguments[2];break;default:return void this.log('Illegal param for "building"',"Error")}for(var c in b)if(b.hasOwnProperty(c)){if(this.hasOwnProperty(c)){if(!a){this.log('Repeat define for "'+c+'"',"Error");continue}this.log('Repeat define for "'+c+'"',"Warning")}this[c]="function"==typeof b[c]&&b.constructor!=g?function(){return"process"!=this.__tailState||this.needSkip(c)||this.log("Running:"+(this.mName||"anonymity")+"."+c,"Record"),b[c].apply(this,arguments)}:b[c],this.log('Success define for "'+c+'"',"Success")}return this},g.prototype.mSend=function(a,b){try{j.push(a,b,this),this.log("Sending data from "+this.mName||"anonymity success!","Success")}catch(c){this.log("Error sending from "+this.mName||"anonymity","Error")}},g.prototype.mMonitor=function(a,b){try{j.addHandler(b||this,a),this.log("Adding monitor in "+this.mName||"anonymity success!","Success")}catch(c){this.log("Error monitor in "+this.mName||"anonymity","Error")}},g.prototype.mUnmonitor=function(a,b){try{j.delHandler(b||this,a),this.log("Deleting monitor in "+this.mName||"anonymity success!","Success")}catch(c){this.log("Error unmonitor in "+this.mName||"anonymity","Error")}},g.prototype.interfaceDefine=function(a,b,c){if(arguments.length<2)return void this.log("Param illegal for Interface defining","Error");if(this.interface.hasOwnProperty(a)){if(!c)return void this.log('Repeat interface defining for "'+a+'"',"Error");this.log('Repeat interface defining for "'+a+'"',"Warning")}"string"==typeof b&&(b=[b]);var d=[];for(var e in b)"string"==typeof b[e]?d.push(b[e]):this.log("Illegal interface methods name for defining!","Error");return this.interface[a]=d,this.log('Success defining for interface "'+a+'"',"Success"),d},g.prototype.interfaceCheck=function(a){var b=[];if("string"==typeof a){if(!this.interface.hasOwnProperty(a))return this.log('The interface name of "'+a+'" is not exist!',"Failure"),!1;b=this.interface[a]}else{if(!e.isWhat(a,"array"))return this.log("Illegal params for interface checking!","Error"),!1;b=a}for(var c=b.length,d=[],f=0;c>f;f++)b[f]in this||d.push(b[f]);return d.length?d:!1},g.prototype.require=function(a,b){h[a]?h[a].link.push({state:"off",module:this}):(h[a]={src:b},h[a].link=[{state:"off",module:this}]),-1==e.indexOf(a,this.rLink)&&this.rLink.push(a)},b.modules={},b.define=function(a){a=e.trim(a);var c=new g(a);if(-1==a.indexOf(".")){if(a in b.modules)throw"Repeat define for "+a;b.modules[a]=c}else{for(var d=a.split("."),f=b.modules,h=0;h<d.length-1;h++)f=f[d[h]]=d[h]in f?f[d[h]]:{};f[d.pop()]=c}return c},b.create=function(a,f){a=e.trim(a);var g;if(-1==a.indexOf("."))g=b.modules[a];else{for(var j=a.split("."),k=b.modules,l=0;l<j.length&&(k=k[j[l]],"undefined"!=typeof k);l++);g=k}if(g){for(var l=0,m=g.rLink.length;m>l;l++)if(!e.isDefined(g.rLink[l],b.modules))return c.autoLoad?void d.loader(h[g.rLink[l]].src,{callBack:function(){b.create(a,f)}}):(g.log("Rely lost for "+g.rLink[l],"Warning"),!1);return e.isArray(f)||(f=[f]),i[g.mName]=g[c.initFnName]&&g[c.initFnName].apply(g,f),i[g.mName]||!0}if(h[a])return c.autoLoad?void d.loader(h[a].src,{callBack:function(){b.create(a)}}):!1;throw"Invalid Input for "+a},b.destroy=function(a){a&&i[a]&&i[a][c.destroyFnName]&&(i[a][c.destroyFnName](),delete i[a])},b.options=function(){var a={};switch(arguments.length){case 2:a[arguments[0]]=arguments[1];break;case 1:a=arguments[0];break;default:return!1}return c=e.paramObj(c,a),!0},b.newM=function(a){return new g(a)},a.$M=b}(window);